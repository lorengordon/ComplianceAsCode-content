prodtype: all
description: 'Rsyslogd is a system utility providing support for message logging.
    Support

    for both internet and UNIX domain sockets enables this utility to support both
    local

    and remote logging.  Couple this utility with <tt>gnutls</tt> (which is a secure
    communications

    library implementing the SSL, TLS and DTLS protocols), and you have a method to
    securely

    encrypt and off-load auditing.


    When using <tt>rsyslogd</tt> to off-load logs off an encryption system must be
    used.'
rationale: 'The audit records generated by Rsyslog contain valuable information regarding
    system

    configuration, user authentication, and other such information. Audit records
    should be

    protected from unauthorized access.'
severity: medium
references:
    disa: CCI-001851
    nist: AU-4(1)
    srg: SRG-OS-000342-GPOS-00133,SRG-OS-000479-GPOS-00224
identifiers: {}
ocil_clause: rsyslogd DefaultNetstreamDriver not set to gtls
ocil: 'Verify the operating system encrypts audit records off-loaded onto a different
    system

    or media from the system being audited with the following commands:


    <pre>$ sudo grep -i ''$DefaultNetstreamDriver'' /etc/rsyslog.conf /etc/rsyslog.d/*.conf</pre>


    The output should be:


    <pre>/etc/rsyslog.conf:$DefaultNetstreamDriver gtls</pre>'
oval_external_content: null
fixtext: 'Configure the operating system to encrypt off-loaded audit records by setting
    the following options in "/etc/rsyslog.conf" or "/etc/rsyslog.d/[customfile].conf":


    $DefaultNetstreamDriver gtls'
checktext: ''
vuldiscussion: ''
srg_requirement: Alibaba Cloud Linux 2 must encrypt the transfer of audit records
    off-loaded onto a different system or media from the system being audited.
warnings: []
conflicts: []
requires: []
policy_specific_content:
    stig:
        srg_requirement: Alibaba Cloud Linux 2 must encrypt via the gtls driver the
            transfer of audit records off-loaded onto a different system or media
            from the system being audited via rsyslog.
        vuldiscussion: 'Information stored in one location is vulnerable to accidental
            or incidental deletion or alteration.


            Off-loading is a common process in information systems with limited audit
            storage capacity.


            Alibaba Cloud Linux 2 installation media provides "rsyslogd".  "rsyslogd"
            is a system utility providing support for message logging.  Support for
            both internet and UNIX domain sockets enables this utility to support
            both local and remote logging.  Couple this utility with "gnutls" (which
            is a secure communications library implementing the SSL, TLS and DTLS
            protocols), and you have a method to securely encrypt and off-load auditing.'
        checktext: 'Verify Alibaba Cloud Linux 2 uses the gtls driver to encrypt audit
            records off-loaded onto a different system or media from the system being
            audited with the following command:


            $ sudo grep -i ''$DefaultNetstreamDriver'' /etc/rsyslog.conf /etc/rsyslog.d/*.conf


            /etc/rsyslog.conf:$DefaultNetstreamDriver gtls


            If the value of the "$DefaultNetstreamDriver" option is not set to "gtls"
            or the line is commented out, this is a finding.'
        fixtext: 'Configure Alibaba Cloud Linux 2 to use the gtls driver to encrypt
            off-loaded audit records by setting the following options in "/etc/rsyslog.conf"
            or "/etc/rsyslog.d/[customfile].conf":


            $DefaultNetstreamDriver gtls'
platform: null
platforms: !!set {}
sce_metadata: {}
inherited_platforms: !!set
    machine: null
cpe_platform_names: !!set {}
inherited_cpe_platform_names: !!set
    machine: null
bash_conditional: null
fixes: {}
title: Ensure Rsyslog Encrypts Off-Loaded Audit Records
definition_location: /home/oscap/content/linux_os/guide/system/logging/ensure_rsyslog_log_file_configuration/rsyslog_encrypt_offload_defaultnetstreamdriver/rule.yml
template: null
documentation_complete: true

prodtype: all
description: "Audit logs are stored in the <tt>/var/log/audit</tt> directory.\n<p>\n\
    Partitioning Red Hat CoreOS is a Day 1 operation and cannot\nbe changed afterwards.\
    \ For documentation on how to add a\nMachineConfig manifest that specifies a separate\
    \ <code>/var/log/audit</code>\npartition, follow:\n\n    <a xmlns='http://www.w3.org/1999/xhtml'\
    \ href='https://docs.openshift.com/container-platform/latest/installing/installing_platform_agnostic/installing-platform-agnostic.html#installation-user-infra-machines-advanced_disk_installing-platform-agnostic'>https://docs.openshift.com/container-platform/latest/installing/installing_platform_agnostic/installing-platform-agnostic.html#installation-user-infra-machines-advanced_disk_installing-platform-agnostic</a>\n\
    </p>\n<p>\nNote that the Red Hat OpenShift documentation often references a block\n\
    device, such as <tt>/dev/vda</tt>. The name of the available block devices depends\n\
    on the underlying infrastructure (bare metal vs cloud), and often the specific\n\
    instance type. For example in AWS, some instance types have NVMe drives\n(<tt>/dev/nvme*</tt>),\
    \ others use <tt>/dev/xvda*</tt>.\n\nYou will need to look for relevant documentation\
    \ for your infrastructure around this.\nIn many cases, the simplest thing is to\
    \ boot a single machine with an Ignition\nconfiguration that just gives you SSH\
    \ access, and inspect the block devices via\ne.g. the <tt>lsblk</tt> command.\n\
    \nFor physical hardware, a good best practice is to reference devices via the\n\
    <tt>/dev/disk/by-id/</tt> or <tt>/dev/disk/by-path</tt> links.\n</p>\n\nMake absolutely\
    \ certain that it is large enough to store all\naudit logs that will be created\
    \ by the auditing daemon."
rationale: 'Placing <tt>/var/log/audit</tt> in its own partition

    enables better separation between audit files

    and other files, and helps ensure that

    auditing cannot be halted due to the partition running out

    of space.'
severity: low
references:
    anssi: BP28(R43)
    cis-csc: 1,12,13,14,15,16,2,3,5,6,8
    cobit5: APO11.04,APO13.01,BAI03.05,BAI04.04,DSS05.02,DSS05.04,DSS05.07,MEA02.01
    disa: CCI-000366,CCI-001849
    hipaa: 164.312(a)(2)(ii)
    isa-62443-2009: 4.3.3.3.9,4.3.3.5.8,4.3.4.4.7,4.4.2.1,4.4.2.2,4.4.2.4
    isa-62443-2013: SR 2.10,SR 2.11,SR 2.12,SR 2.8,SR 2.9,SR 3.1,SR 3.5,SR 3.8,SR
        4.1,SR 4.3,SR 5.1,SR 5.2,SR 5.3,SR 7.1,SR 7.2,SR 7.6
    iso27001-2013: A.12.1.3,A.12.4.1,A.12.4.2,A.12.4.3,A.12.4.4,A.12.7.1,A.13.1.1,A.13.2.1,A.14.1.3,A.17.2.1
    nerc-cip: CIP-007-3 R6.5
    nist: CM-6(a),AU-4,SC-5(2)
    nist-csf: PR.DS-4,PR.PT-1,PR.PT-4
    ospp: FMT_SMF_EXT.1
    srg: SRG-OS-000341-GPOS-00132,SRG-OS-000480-GPOS-00227
identifiers:
    cce: CCE-82738-6
ocil_clause: '"/var/log/audit is not a mountpoint" is returned'
ocil: 'You''ll need to log into a node in the cluster.

    As a user with administrator privileges, log into a node in the relevant pool:

    <pre>

    $ oc debug node/$NODE_NAME

    </pre>

    At the <pre>sh-4.4#</pre> prompt, run:

    <pre>

    # chroot /host

    </pre>


    Subsequently,Verify that a separate file system/partition has been created for
    <code>/var/log/audit</code> with the following command:


    <pre>$ mountpoint /var/log/audit</pre>

    '
oval_external_content: null
fixtext: Migrate the system audit data path onto a separate file system.
checktext: ''
vuldiscussion: ''
srg_requirement: Red Hat Enterprise Linux CoreOS 4 must use a separate file system
    for the system audit data path.
warnings: []
conflicts: []
requires: []
policy_specific_content:
    stig:
        srg_requirement: Red Hat Enterprise Linux CoreOS 4 must use a separate file
            system for the system audit data path.
        vuldiscussion: 'Placing "/var/log/audit" in its own partition enables better
            separation between audit files and other system files, and helps ensure
            that

            auditing cannot be halted due to the partition running out of space.'
        checktext: 'Verify that a separate file system/partition has been created
            for the system audit data path with the following command:


            Note: /var/log/audit is used as the example as it is a common location.


            $ mount | grep /var/log/audit


            UUID=2efb2979-45ac-82d7-0ae632d11f51 on /var/log/home type xfs  (rw,realtime,seclabel,attr2,inode64)


            If no line is returned, this is a finding.'
        fixtext: Migrate the system audit data path onto a separate file system.
platform: machine
platforms: !!set
    machine: null
sce_metadata: {}
inherited_platforms: !!set {}
cpe_platform_names: !!set
    machine: null
inherited_cpe_platform_names: !!set {}
bash_conditional: null
fixes: {}
title: Ensure /var/log/audit Located On Separate Partition
definition_location: /home/oscap/content/linux_os/guide/system/software/disk_partitioning/partition_for_var_log_audit/rule.yml
template: null
documentation_complete: true

prodtype: all
description: 'A Machine Check Exception is an error generated by the CPU itdetects
    an error

    in itself, memory or I/O devices.

    These errors may be corrected and generate a check log entry, if an error

    cannot be corrected the kernel may panic or SIGBUS.


    To force the kernel to panic on any uncorrected error reported by Machine Check

    set the MCE tolerance to zero by adding <tt>mce=0</tt>

    to the default GRUB 2 command line for the Linux operating system.

    To ensure that <tt>mce=0</tt> is added as a kernel command line

    argument to newly installed kernels, add <tt>mce=0</tt> to the

    default Grub2 command line for Linux operating systems. Modify the line within

    <tt>/etc/default/grub</tt> as shown below:

    <pre>GRUB_CMDLINE_LINUX="... mce=0 ..."</pre>

    Run the following command to update command line for already installed kernels:<pre>#
    grubby --update-kernel=ALL --args="mce=0"</pre>'
rationale: 'Allowing uncorrected errors to result on a SIGBUS may allow an attacker
    to continue

    trying to exploit a vulnerability such as Rowhammer.'
severity: medium
references:
    anssi: BP28(R8)
identifiers:
    cce: CCE-90774-1
ocil_clause: MCE tolerance is not set to zero
ocil: 'Inspect the form of default GRUB 2 command line for the Linux operating system

    in <tt>/etc/default/grub</tt>. If it includes <tt>mce=0</tt>,

    then the parameter will be configured for newly installed kernels.

    First check if the GRUB recovery is enabled:

    <pre>$ sudo grep ''GRUB_DISABLE_RECOVERY'' /etc/default/grub</pre>

    If this option is set to true, then check that a line is output by the following
    command:

    <pre>$ sudo grep ''GRUB_CMDLINE_LINUX_DEFAULT.*mce=0.*'' /etc/default/grub</pre>

    If the recovery is disabled, check the line with

    <pre>$ sudo grep ''GRUB_CMDLINE_LINUX.*mce=0.*'' /etc/default/grub</pre>.Moreover,
    command line parameters for currently installed kernels should be checked as well.

    Run the following command:

    <pre>$ sudo grubby --info=ALL | grep args | grep -v ''mce=0''</pre>

    The command should not return any output.'
oval_external_content: null
fixtext: ''
checktext: ''
vuldiscussion: ''
srg_requirement: ''
warnings: []
conflicts: []
requires: []
policy_specific_content: {}
platform: machine
platforms: !!set
    machine: null
sce_metadata: {}
inherited_platforms: !!set
    grub2: null
cpe_platform_names: !!set
    machine: null
inherited_cpe_platform_names: !!set
    grub2: null
bash_conditional: null
fixes: {}
title: Force kernel panic on uncorrected MCEs
definition_location: /home/oscap/content/linux_os/guide/system/bootloader-grub2/grub2_mce_argument/rule.yml
template:
    name: grub2_bootloader_argument
    vars:
        arg_name: mce
        arg_value: '0'
    backends: {}
documentation_complete: true

prodtype: fedora,ol8,ol9,rhcos4,rhel8,rhel9
description: 'To set the runtime status of the <code>net.core.bpf_jit_harden</code>
    kernel parameter, run the following command: <pre>$ sudo sysctl -w net.core.bpf_jit_harden=2</pre>

    To make sure that the setting is persistent, add the following line to a file
    in the directory <tt>/etc/sysctl.d</tt>: <pre>net.core.bpf_jit_harden = 2</pre>'
rationale: 'When hardened, the extended Berkeley Packet Filter just-in-time compiler

    will randomize any kernel addresses in the BPF programs and maps,

    and will not expose the JIT addresses in <tt>/proc/kallsyms</tt>.'
severity: medium
references:
    anssi: BP28(R12)
    disa: CCI-000366
    nist: CM-6,SC-7(10)
    ospp: FMT_SMF_EXT.1
    srg: SRG-OS-000480-GPOS-00227
    stigid: RHEL-08-040286
    stigref: SV-244554r858832_rule
identifiers:
    cce: CCE-82934-1
ocil_clause: the correct value is not returned
ocil: 'The runtime status of the <code>net.core.bpf_jit_harden</code> kernel parameter
    can be queried

    by running the following command:

    <pre>$ sysctl net.core.bpf_jit_harden</pre>

    <code>2</code>.

    '
oval_external_content: null
fixtext: 'Configure Red Hat Enterprise Linux 8  to enable hardening for the BPF JIT
    compiler.

    Add or edit the following line in a system configuration file in the "/etc/sysctl.d/"
    directory:

    net.core.bpf_jit_harden = 2


    Load settings from all system configuration files with the following command:


    $ sudo sysctl --system'
checktext: ''
vuldiscussion: ''
srg_requirement: Red Hat Enterprise Linux 8 must enable hardening for the Berkeley
    Packet Filter Just-in-time compiler.
warnings: []
conflicts: []
requires: []
policy_specific_content:
    stig:
        srg_requirement: Red Hat Enterprise Linux 8 must enable hardening for the
            Berkeley Packet Filter Just-in-time compiler.
        vuldiscussion: 'When hardened, the extended Berkeley Packet Filter just-in-time
            compiler

            will randomize any kernel addresses in the BPF programs and maps,

            and will not expose the JIT addresses in "/proc/kallsyms".'
        checktext: 'Verify Red Hat Enterprise Linux 8 enables hardening for the BPF
            JIT with the following commands:


            $ sudo sysctl net.core.bpf_jit_harden


            net.core.bpf_jit_harden = 2


            If the returned line does not have a value of "2", or a line is not returned,
            this is a finding.


            Check that the configuration files are present to enable this kernel parameter.


            $ sudo /usr/lib/systemd/systemd-sysctl --cat-config | egrep -v ''^(#|;)''
            | grep -F net.core.bpf_jit_harden | tail -1

            net.core.bpf_jit_harden = 2


            If the network parameter "net.core.bpf_jit_harden" is not equal to "2"
            or nothing is returned, this is a finding.'
        fixtext: 'Configure Red Hat Enterprise Linux 8 to enable hardening for the
            BPF JIT compiler by adding the following line to a file, in the "/etc/sysctl.d"
            directory:


            net.core.bpf_jit_harden = 2


            The system configuration files need to be reloaded for the changes to
            take effect. To reload the contents of the files, run the following command:


            $ sudo sysctl --system'
platform: machine
platforms: !!set
    machine: null
sce_metadata: {}
inherited_platforms: !!set {}
cpe_platform_names: !!set
    machine: null
inherited_cpe_platform_names: !!set {}
bash_conditional: null
fixes: {}
title: Harden the operation of the BPF just-in-time compiler
definition_location: /home/oscap/content/linux_os/guide/system/permissions/restrictions/sysctl_net_core_bpf_jit_harden/rule.yml
template:
    name: sysctl
    vars:
        sysctlvar: net.core.bpf_jit_harden
        sysctlval: '2'
        datatype: int
    backends: {}
documentation_complete: true

prodtype: rhel7,rhel8,rhel9,ubuntu2004,ubuntu2204
description: 'rsyslog will create logfiles that do not already exist on the system.

    This settings controls what permissions will be applied to these newly

    created files.'
rationale: 'It is important to ensure that log files have the correct permissions

    to ensure that sensitive data is archived and protected.'
severity: medium
references:
    cis: 4.2.1.4
identifiers:
    cce: CCE-88322-3
ocil_clause: $FileCreateMode is not set or is more permissive than 0640
ocil: 'Run the following command:

    <pre># grep ^\$FileCreateMode /etc/rsyslog.conf /etc/rsyslog.d/*.conf</pre>

    Verify the output matches:

    <pre>$FileCreateMode 0640</pre>

    Should a site policy dictate less restrictive permissions, ensure to follow

    said policy.'
oval_external_content: null
fixtext: 'Edit either `/etc/rsyslog.conf` or a dedicated .conf file in `/etc/rsyslog.d/`

    and set $FileCreateMode to 0640 or more restrictive:

    $FileCreateMode 0640

    Restart the service:

    # systemctl restart rsyslog'
checktext: ''
vuldiscussion: ''
srg_requirement: ''
warnings: []
conflicts: []
requires: []
policy_specific_content: {}
platform: null
platforms: !!set {}
sce_metadata: {}
inherited_platforms: !!set
    machine: null
cpe_platform_names: !!set {}
inherited_cpe_platform_names: !!set
    machine: null
bash_conditional: null
fixes: {}
title: Ensure rsyslog Default File Permissions Configured
definition_location: /home/oscap/content/linux_os/guide/system/logging/rsyslog_filecreatemode/rule.yml
template: null
documentation_complete: true

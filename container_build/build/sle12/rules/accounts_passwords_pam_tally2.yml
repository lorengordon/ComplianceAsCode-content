prodtype: sle12,sle15,ubuntu2004
description: 'The SUSE Linux Enterprise 12 operating system must lock an account after
    - at most - <sub idref="var_password_pam_tally2" />

    consecutive invalid access attempts.'
rationale: 'By limiting the number of failed logon attempts, the risk of unauthorized

    system access via user password guessing, otherwise known as brute-force

    attacks, is reduced. Limits are imposed by locking the account.


    To configure the operating system to lock an account after three

    unsuccessful consecutive access attempts using <tt>pam_tally2.so</tt>,

    modify the content of both <tt>/etc/pam.d/common-auth</tt> and

    <tt>/etc/pam.d/common-account</tt> as follows:

    <br /><br />

    <ul>

    <li> add or modify the <tt>pam_tally2.so</tt> module line in

    <tt>/etc/pam.d/common-auth</tt> to ensure both <tt>onerr=fail</tt> and

    <tt>deny=<sub idref="var_password_pam_tally2" /></tt> are present. For example:

    <pre>auth required pam_tally2.so onerr=fail silent audit deny=<sub idref="var_password_pam_tally2"
    /></pre></li>

    <li> add or modify the following line in <tt>/etc/pam.d/common-account</tt>:

    <pre>account required pam_tally2.so</pre></li>

    </ul>'
severity: medium
references:
    disa: CCI-000044
    nist: AC-7(a)
    pcidss: Req-8.1.6
    pcidss4: 8.3.4
    srg: SRG-OS-000021-GPOS-00005
    stigid: SLES-12-010130
    cis: 5.3.2
    stigref: SV-217114r603262_rule
identifiers:
    cce: CCE-83055-4
ocil_clause: the account option is missing or commented out
ocil: 'Check that the systems locks a user account after - at most - <tt><sub idref="var_password_pam_tally2"
    /></tt>

    consecutive failed login attempts with the following command:


    <pre># grep pam_tally2.so /etc/pam.d/common-auth

    auth required pam_tally2.so onerr=fail deny=<sub idref="var_password_pam_tally2"
    /></pre>


    If no line is returned, the line is commented out, or the line is missing

    "onerr=fail", this is a finding.

    If the line has "deny" set to a value outside of the range <pre>1-<sub idref="var_password_pam_tally2"
    /></pre>,

    this is a finding.


    Check that the system resets the failed login attempts counter after a

    successful login using the following command:


    <pre># grep pam_tally2.so /etc/pam.d/common-account

    account required pam_tally2.so deny=<sub idref="var_password_pam_tally2" /></pre>


    If the account option is missing, or commented out, this is a finding.'
oval_external_content: null
fixtext: ''
checktext: ''
vuldiscussion: ''
srg_requirement: ''
warnings: []
conflicts: []
requires: []
policy_specific_content: {}
platform: package[pam]
platforms: !!set
    package[pam]: null
sce_metadata: {}
inherited_platforms: !!set {}
cpe_platform_names: !!set
    package_pam: null
inherited_cpe_platform_names: !!set {}
bash_conditional: null
fixes: {}
title: Set Deny For Failed Password Attempts
definition_location: /home/oscap/content/linux_os/guide/system/accounts/accounts-pam/locking_out_password_attempts/accounts_passwords_pam_tally2/rule.yml
template: null
documentation_complete: true

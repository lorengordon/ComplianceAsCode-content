prodtype: alinux2,rhel7,sle12,sle15,ubuntu2004,ubuntu2204
description: 'At a minimum, the audit system should collect the execution of

    privileged commands for all users and root. If the <tt>auditd</tt> daemon is

    configured to use the <tt>augenrules</tt> program to read audit rules during

    daemon startup (the default), add a line of the following form to a file with

    suffix <tt>.rules</tt> in the directory <tt>/etc/audit/rules.d</tt>:

    <pre>-w /sbin/modprobe -p x -k modules</pre>

    If the <tt>auditd</tt> daemon is configured to use the <tt>auditctl</tt>

    utility to read audit rules during daemon startup, add a line of the following

    form to <tt>/etc/audit/audit.rules</tt>:

    <pre>-w /sbin/modprobe -p x -k modules</pre>'
rationale: 'Misuse of privileged functions, either intentionally or unintentionally
    by

    authorized users, or by unauthorized external entities that have compromised system
    accounts,

    is a serious and ongoing concern and can have significant adverse impacts on organizations.

    Auditing the use of privileged functions is one way to detect such misuse and
    identify

    the risk from insider and advanced persistent threats.

    <br /><br />

    Privileged programs are subject to escalation-of-privilege attacks,

    which attempt to subvert their normal role of providing some necessary but

    limited capability. As such, motivation exists to monitor these programs for

    unusual activity.'
severity: medium
references:
    anssi: BP28(R73)
    disa: CCI-000130,CCI-000169,CCI-000172,CCI-002884
    nist: AU-12(a),AU-12.1(ii),AU-3,AU-3.1,AU-12(c),AU-12.1(iv),MA-4(1)(a)
    srg: SRG-OS-000037-GPOS-00015,SRG-OS-000062-GPOS-00031,SRG-OS-000392-GPOS-00172,SRG-OS-000462-GPOS-00206,SRG-OS-000471-GPOS-00215
    stigid: SLES-15-030400
    cis: 4.1.16
    stigref: SV-234939r622137_rule
identifiers:
    cce: CCE-85731-8
ocil_clause: the command does not return a line, or the line is commented out
ocil: "To verify that auditing of privileged command use is configured, run the\n\
    following command:\n<pre>\n  sudo auditctl -l | grep -w '/sbin/modprobe'\n  -w\
    \ /sbin/modprobe -p x -k modules\n</pre>\nIt should return a relevant line in\
    \ the audit rules."
oval_external_content: null
fixtext: ''
checktext: ''
vuldiscussion: ''
srg_requirement: ''
warnings: []
conflicts: []
requires: []
policy_specific_content: {}
platform: machine
platforms: !!set
    machine: null
sce_metadata: {}
inherited_platforms: !!set
    machine: null
    package[audit]: null
cpe_platform_names: !!set
    machine: null
inherited_cpe_platform_names: !!set
    package_audit: null
    machine: null
bash_conditional: null
fixes: {}
title: Ensure auditd Collects Information on the Use of Privileged Commands - modprobe
definition_location: /home/oscap/content/linux_os/guide/system/auditing/auditd_configure_rules/audit_privileged_commands/audit_rules_privileged_commands_modprobe/rule.yml
template: null
documentation_complete: true

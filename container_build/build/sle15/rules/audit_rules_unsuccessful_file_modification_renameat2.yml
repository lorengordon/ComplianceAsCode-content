prodtype: sle15
description: "The operating system must generate audit records for all uses of the\
    \ <tt>renameat2</tt> system call.\nWithout generating audit records specific to\
    \ the security and mission needs of the organization, it would be \ndifficult\
    \ to establish, correlate, and investigate the events relating to an incident\
    \ or identify those responsible for one.\nAudit records can be generated from\
    \ various components within the information system (e.g., module or policy filter).\n\
    Add or update the following lines to <tt>/etc/audit/rules.d/audit.rules</tt> to\
    \ configure the operating system to generate \nan audit record for all uses of\
    \ the <tt>renameat2</tt> system call:  \n<pre>\n-a always,exit -F arch=b32 -S\
    \ renameat2 -F auid>=1000 -F auid!=-1 -k perm_mod\n-a always,exit -F arch=b64\
    \ -S renameat2 -F auid>=1000 -F auid!=-1 -k perm_mod</pre>"
rationale: 'Unsuccessful attempts to delete files could be an indicator of malicious
    activity on a system. Auditing

    these events could serve as evidence of potential system compromise.'
severity: medium
references:
    disa: CCI-000172
    nist: AU-12(c),AU-12.1(iv)
    srg: SRG-OS-000468-GPOS-00212
    stigid: SLES-15-030740
    stigref: SV-234973r622137_rule
identifiers:
    cce: CCE-85726-8
ocil_clause: no line is returned
ocil: 'To determine if the system is configured to audit unsuccessful calls

    to the <code>renameat2</code> system call, run the following command:

    <pre space="preserve">$ sudo grep "renameat2" /etc/audit.*</pre>

    If the system is configured to audit this activity, it will return a line.

    '
oval_external_content: null
fixtext: ''
checktext: ''
vuldiscussion: ''
srg_requirement: ''
warnings:
-   general: 'Note that these rules can be configured in a

        number of ways while still achieving the desired effect. Here the system calls

        have been placed independent of other system calls. Grouping system calls
        related

        to the same event is more efficient. See the following example:

        <pre>

        -a always,exit -F arch=b32 -S renameat2 -F auid>=1000 -F auid!=4294967295
        -k perm_mod

        -a always,exit -F arch=b64 -S renameat2 -F auid>=1000 -F auid!=4294967295
        -k perm_mod</pre>'
conflicts: []
requires: []
policy_specific_content: {}
platform: null
platforms: !!set {}
sce_metadata: {}
inherited_platforms: !!set
    machine: null
    package[audit]: null
cpe_platform_names: !!set {}
inherited_cpe_platform_names: !!set
    package_audit: null
    machine: null
bash_conditional: null
fixes: {}
title: Record Unsuccessful Delete Attempts to Files - renameat2
definition_location: /home/oscap/content/linux_os/guide/system/auditing/auditd_configure_rules/audit_file_modification/audit_rules_unsuccessful_file_modification_renameat2/rule.yml
template:
    name: audit_rules_unsuccessful_file_modification
    vars:
        name: renameat2
        syscall_grouping:
        - rename
        - renameat
        - renameat2
        - unlink
        - unlinkat
    backends: {}
documentation_complete: true

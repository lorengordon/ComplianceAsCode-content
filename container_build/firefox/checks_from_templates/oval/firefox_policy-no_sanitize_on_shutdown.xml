<def-group>
  <definition class="compliance" id="firefox_policy-no_sanitize_on_shutdown" version="1">
    <metadata>
        <title>Firefox must be configured to not delete data upon shutdown.</title>
            <affected family="unix">
                <platform>Mozilla Firefox</platform>
            </affected>
        <description>Check setting of Require default personal certificate be chosen every time in Firefox policy</description>
    </metadata> 
    <criteria operator="AND" comment="Test conditions - Firefox policy item is set.">
     
      <criterion comment="Check that Firefox administrative policy setting SanitizeOnShutdown.Cache to 'false'." test_ref="test_firefox_policy-no_sanitize_on_shutdown_SanitizeOnShutdown_Cache" />
     
      <criterion comment="Check that Firefox administrative policy setting SanitizeOnShutdown.Cookies to 'false'." test_ref="test_firefox_policy-no_sanitize_on_shutdown_SanitizeOnShutdown_Cookies" />
     
      <criterion comment="Check that Firefox administrative policy setting SanitizeOnShutdown.Downloads to 'false'." test_ref="test_firefox_policy-no_sanitize_on_shutdown_SanitizeOnShutdown_Downloads" />
     
      <criterion comment="Check that Firefox administrative policy setting SanitizeOnShutdown.FormData to 'false'." test_ref="test_firefox_policy-no_sanitize_on_shutdown_SanitizeOnShutdown_FormData" />
     
      <criterion comment="Check that Firefox administrative policy setting SanitizeOnShutdown.History to 'false'." test_ref="test_firefox_policy-no_sanitize_on_shutdown_SanitizeOnShutdown_History" />
     
      <criterion comment="Check that Firefox administrative policy setting SanitizeOnShutdown.Sessions to 'false'." test_ref="test_firefox_policy-no_sanitize_on_shutdown_SanitizeOnShutdown_Sessions" />
     
      <criterion comment="Check that Firefox administrative policy setting SanitizeOnShutdown.SiteSettings to 'false'." test_ref="test_firefox_policy-no_sanitize_on_shutdown_SanitizeOnShutdown_SiteSettings" />
     
      <criterion comment="Check that Firefox administrative policy setting SanitizeOnShutdown.OfflineApps to 'false'." test_ref="test_firefox_policy-no_sanitize_on_shutdown_SanitizeOnShutdown_OfflineApps" />
     
      <criterion comment="Check that Firefox administrative policy setting SanitizeOnShutdown.Locked to 'true'." test_ref="test_firefox_policy-no_sanitize_on_shutdown_SanitizeOnShutdown_Locked" />
     
    </criteria>
  </definition>


  <ind:textfilecontent54_test check="all"
  comment="Check setting of SanitizeOnShutdown.Cache in Firefox policy file" 
  id="test_firefox_policy-no_sanitize_on_shutdown_SanitizeOnShutdown_Cache" version="1">
  <ind:object object_ref="obj_firefox_policy-no_sanitize_on_shutdown_SanitizeOnShutdown_Cache" />
  <ind:state state_ref="state_firefox_policy-no_sanitize_on_shutdown_SanitizeOnShutdown_Cache" />
  </ind:textfilecontent54_test>


  <ind:textfilecontent54_test check="all"
  comment="Check setting of SanitizeOnShutdown.Cookies in Firefox policy file" 
  id="test_firefox_policy-no_sanitize_on_shutdown_SanitizeOnShutdown_Cookies" version="1">
  <ind:object object_ref="obj_firefox_policy-no_sanitize_on_shutdown_SanitizeOnShutdown_Cookies" />
  <ind:state state_ref="state_firefox_policy-no_sanitize_on_shutdown_SanitizeOnShutdown_Cookies" />
  </ind:textfilecontent54_test>


  <ind:textfilecontent54_test check="all"
  comment="Check setting of SanitizeOnShutdown.Downloads in Firefox policy file" 
  id="test_firefox_policy-no_sanitize_on_shutdown_SanitizeOnShutdown_Downloads" version="1">
  <ind:object object_ref="obj_firefox_policy-no_sanitize_on_shutdown_SanitizeOnShutdown_Downloads" />
  <ind:state state_ref="state_firefox_policy-no_sanitize_on_shutdown_SanitizeOnShutdown_Downloads" />
  </ind:textfilecontent54_test>


  <ind:textfilecontent54_test check="all"
  comment="Check setting of SanitizeOnShutdown.FormData in Firefox policy file" 
  id="test_firefox_policy-no_sanitize_on_shutdown_SanitizeOnShutdown_FormData" version="1">
  <ind:object object_ref="obj_firefox_policy-no_sanitize_on_shutdown_SanitizeOnShutdown_FormData" />
  <ind:state state_ref="state_firefox_policy-no_sanitize_on_shutdown_SanitizeOnShutdown_FormData" />
  </ind:textfilecontent54_test>


  <ind:textfilecontent54_test check="all"
  comment="Check setting of SanitizeOnShutdown.History in Firefox policy file" 
  id="test_firefox_policy-no_sanitize_on_shutdown_SanitizeOnShutdown_History" version="1">
  <ind:object object_ref="obj_firefox_policy-no_sanitize_on_shutdown_SanitizeOnShutdown_History" />
  <ind:state state_ref="state_firefox_policy-no_sanitize_on_shutdown_SanitizeOnShutdown_History" />
  </ind:textfilecontent54_test>


  <ind:textfilecontent54_test check="all"
  comment="Check setting of SanitizeOnShutdown.Sessions in Firefox policy file" 
  id="test_firefox_policy-no_sanitize_on_shutdown_SanitizeOnShutdown_Sessions" version="1">
  <ind:object object_ref="obj_firefox_policy-no_sanitize_on_shutdown_SanitizeOnShutdown_Sessions" />
  <ind:state state_ref="state_firefox_policy-no_sanitize_on_shutdown_SanitizeOnShutdown_Sessions" />
  </ind:textfilecontent54_test>


  <ind:textfilecontent54_test check="all"
  comment="Check setting of SanitizeOnShutdown.SiteSettings in Firefox policy file" 
  id="test_firefox_policy-no_sanitize_on_shutdown_SanitizeOnShutdown_SiteSettings" version="1">
  <ind:object object_ref="obj_firefox_policy-no_sanitize_on_shutdown_SanitizeOnShutdown_SiteSettings" />
  <ind:state state_ref="state_firefox_policy-no_sanitize_on_shutdown_SanitizeOnShutdown_SiteSettings" />
  </ind:textfilecontent54_test>


  <ind:textfilecontent54_test check="all"
  comment="Check setting of SanitizeOnShutdown.OfflineApps in Firefox policy file" 
  id="test_firefox_policy-no_sanitize_on_shutdown_SanitizeOnShutdown_OfflineApps" version="1">
  <ind:object object_ref="obj_firefox_policy-no_sanitize_on_shutdown_SanitizeOnShutdown_OfflineApps" />
  <ind:state state_ref="state_firefox_policy-no_sanitize_on_shutdown_SanitizeOnShutdown_OfflineApps" />
  </ind:textfilecontent54_test>


  <ind:textfilecontent54_test check="all"
  comment="Check setting of SanitizeOnShutdown.Locked in Firefox policy file" 
  id="test_firefox_policy-no_sanitize_on_shutdown_SanitizeOnShutdown_Locked" version="1">
  <ind:object object_ref="obj_firefox_policy-no_sanitize_on_shutdown_SanitizeOnShutdown_Locked" />
  <ind:state state_ref="state_firefox_policy-no_sanitize_on_shutdown_SanitizeOnShutdown_Locked" />
  </ind:textfilecontent54_test>


  <unix:file_object id="obj_firefox_policy-no_sanitize_on_shutdown_firefox_path" version="1" comment="Find all installations of Firefox">
    <unix:behaviors recurse_direction="down" max_depth="-1" recurse_file_system="all" />
    <unix:path>/usr</unix:path>
    <unix:filename operation="pattern match">^firefox.sh$|^firefox-bin$</unix:filename>
  </unix:file_object>
  <local_variable id="var_firefox_policy-no_sanitize_on_shutdown_firefox_path" version="1" datatype="string" comment="policies.json path for Firefox.">
      <unique>
      <literal_component>/etc/firefox/policies</literal_component>
      <concat>
          <object_component object_ref="obj_firefox_policy-no_sanitize_on_shutdown_firefox_path" item_field="path" />
          <literal_component>/distribution</literal_component>
      </concat>
      </unique>
  </local_variable>
  
  <ind:textfilecontent54_object id="obj_firefox_policy-no_sanitize_on_shutdown_SanitizeOnShutdown_Cache" version="1">
    <ind:path var_ref="var_firefox_policy-no_sanitize_on_shutdown_firefox_path" var_check="at least one" datatype="string" />
    <ind:filename datatype="string">policies.json</ind:filename>
    <ind:pattern operation="pattern match">^(?i)\{\s*(?="policies")"policies"[\s]*:[\s]*\{[\s\S]*(?="SanitizeOnShutdown")"SanitizeOnShutdown"[\s]*:[\s]*\{[\s\S]*?(?=[^"])Cache"[\s]*:[\s]*([^,}]+),?\s*</ind:pattern>
    <ind:instance datatype="int">1</ind:instance>
  </ind:textfilecontent54_object>
  <ind:textfilecontent54_state id="state_firefox_policy-no_sanitize_on_shutdown_SanitizeOnShutdown_Cache" version="1">
      <ind:subexpression datatype="string" entity_check="all" operation="pattern match">[Ff]alse</ind:subexpression>
  </ind:textfilecontent54_state>
  
  <ind:textfilecontent54_object id="obj_firefox_policy-no_sanitize_on_shutdown_SanitizeOnShutdown_Cookies" version="1">
    <ind:path var_ref="var_firefox_policy-no_sanitize_on_shutdown_firefox_path" var_check="at least one" datatype="string" />
    <ind:filename datatype="string">policies.json</ind:filename>
    <ind:pattern operation="pattern match">^(?i)\{\s*(?="policies")"policies"[\s]*:[\s]*\{[\s\S]*(?="SanitizeOnShutdown")"SanitizeOnShutdown"[\s]*:[\s]*\{[\s\S]*?(?=[^"])Cookies"[\s]*:[\s]*([^,}]+),?\s*</ind:pattern>
    <ind:instance datatype="int">1</ind:instance>
  </ind:textfilecontent54_object>
  <ind:textfilecontent54_state id="state_firefox_policy-no_sanitize_on_shutdown_SanitizeOnShutdown_Cookies" version="1">
      <ind:subexpression datatype="string" entity_check="all" operation="pattern match">[Ff]alse</ind:subexpression>
  </ind:textfilecontent54_state>
  
  <ind:textfilecontent54_object id="obj_firefox_policy-no_sanitize_on_shutdown_SanitizeOnShutdown_Downloads" version="1">
    <ind:path var_ref="var_firefox_policy-no_sanitize_on_shutdown_firefox_path" var_check="at least one" datatype="string" />
    <ind:filename datatype="string">policies.json</ind:filename>
    <ind:pattern operation="pattern match">^(?i)\{\s*(?="policies")"policies"[\s]*:[\s]*\{[\s\S]*(?="SanitizeOnShutdown")"SanitizeOnShutdown"[\s]*:[\s]*\{[\s\S]*?(?=[^"])Downloads"[\s]*:[\s]*([^,}]+),?\s*</ind:pattern>
    <ind:instance datatype="int">1</ind:instance>
  </ind:textfilecontent54_object>
  <ind:textfilecontent54_state id="state_firefox_policy-no_sanitize_on_shutdown_SanitizeOnShutdown_Downloads" version="1">
      <ind:subexpression datatype="string" entity_check="all" operation="pattern match">[Ff]alse</ind:subexpression>
  </ind:textfilecontent54_state>
  
  <ind:textfilecontent54_object id="obj_firefox_policy-no_sanitize_on_shutdown_SanitizeOnShutdown_FormData" version="1">
    <ind:path var_ref="var_firefox_policy-no_sanitize_on_shutdown_firefox_path" var_check="at least one" datatype="string" />
    <ind:filename datatype="string">policies.json</ind:filename>
    <ind:pattern operation="pattern match">^(?i)\{\s*(?="policies")"policies"[\s]*:[\s]*\{[\s\S]*(?="SanitizeOnShutdown")"SanitizeOnShutdown"[\s]*:[\s]*\{[\s\S]*?(?=[^"])FormData"[\s]*:[\s]*([^,}]+),?\s*</ind:pattern>
    <ind:instance datatype="int">1</ind:instance>
  </ind:textfilecontent54_object>
  <ind:textfilecontent54_state id="state_firefox_policy-no_sanitize_on_shutdown_SanitizeOnShutdown_FormData" version="1">
      <ind:subexpression datatype="string" entity_check="all" operation="pattern match">[Ff]alse</ind:subexpression>
  </ind:textfilecontent54_state>
  
  <ind:textfilecontent54_object id="obj_firefox_policy-no_sanitize_on_shutdown_SanitizeOnShutdown_History" version="1">
    <ind:path var_ref="var_firefox_policy-no_sanitize_on_shutdown_firefox_path" var_check="at least one" datatype="string" />
    <ind:filename datatype="string">policies.json</ind:filename>
    <ind:pattern operation="pattern match">^(?i)\{\s*(?="policies")"policies"[\s]*:[\s]*\{[\s\S]*(?="SanitizeOnShutdown")"SanitizeOnShutdown"[\s]*:[\s]*\{[\s\S]*?(?=[^"])History"[\s]*:[\s]*([^,}]+),?\s*</ind:pattern>
    <ind:instance datatype="int">1</ind:instance>
  </ind:textfilecontent54_object>
  <ind:textfilecontent54_state id="state_firefox_policy-no_sanitize_on_shutdown_SanitizeOnShutdown_History" version="1">
      <ind:subexpression datatype="string" entity_check="all" operation="pattern match">[Ff]alse</ind:subexpression>
  </ind:textfilecontent54_state>
  
  <ind:textfilecontent54_object id="obj_firefox_policy-no_sanitize_on_shutdown_SanitizeOnShutdown_Sessions" version="1">
    <ind:path var_ref="var_firefox_policy-no_sanitize_on_shutdown_firefox_path" var_check="at least one" datatype="string" />
    <ind:filename datatype="string">policies.json</ind:filename>
    <ind:pattern operation="pattern match">^(?i)\{\s*(?="policies")"policies"[\s]*:[\s]*\{[\s\S]*(?="SanitizeOnShutdown")"SanitizeOnShutdown"[\s]*:[\s]*\{[\s\S]*?(?=[^"])Sessions"[\s]*:[\s]*([^,}]+),?\s*</ind:pattern>
    <ind:instance datatype="int">1</ind:instance>
  </ind:textfilecontent54_object>
  <ind:textfilecontent54_state id="state_firefox_policy-no_sanitize_on_shutdown_SanitizeOnShutdown_Sessions" version="1">
      <ind:subexpression datatype="string" entity_check="all" operation="pattern match">[Ff]alse</ind:subexpression>
  </ind:textfilecontent54_state>
  
  <ind:textfilecontent54_object id="obj_firefox_policy-no_sanitize_on_shutdown_SanitizeOnShutdown_SiteSettings" version="1">
    <ind:path var_ref="var_firefox_policy-no_sanitize_on_shutdown_firefox_path" var_check="at least one" datatype="string" />
    <ind:filename datatype="string">policies.json</ind:filename>
    <ind:pattern operation="pattern match">^(?i)\{\s*(?="policies")"policies"[\s]*:[\s]*\{[\s\S]*(?="SanitizeOnShutdown")"SanitizeOnShutdown"[\s]*:[\s]*\{[\s\S]*?(?=[^"])SiteSettings"[\s]*:[\s]*([^,}]+),?\s*</ind:pattern>
    <ind:instance datatype="int">1</ind:instance>
  </ind:textfilecontent54_object>
  <ind:textfilecontent54_state id="state_firefox_policy-no_sanitize_on_shutdown_SanitizeOnShutdown_SiteSettings" version="1">
      <ind:subexpression datatype="string" entity_check="all" operation="pattern match">[Ff]alse</ind:subexpression>
  </ind:textfilecontent54_state>
  
  <ind:textfilecontent54_object id="obj_firefox_policy-no_sanitize_on_shutdown_SanitizeOnShutdown_OfflineApps" version="1">
    <ind:path var_ref="var_firefox_policy-no_sanitize_on_shutdown_firefox_path" var_check="at least one" datatype="string" />
    <ind:filename datatype="string">policies.json</ind:filename>
    <ind:pattern operation="pattern match">^(?i)\{\s*(?="policies")"policies"[\s]*:[\s]*\{[\s\S]*(?="SanitizeOnShutdown")"SanitizeOnShutdown"[\s]*:[\s]*\{[\s\S]*?(?=[^"])OfflineApps"[\s]*:[\s]*([^,}]+),?\s*</ind:pattern>
    <ind:instance datatype="int">1</ind:instance>
  </ind:textfilecontent54_object>
  <ind:textfilecontent54_state id="state_firefox_policy-no_sanitize_on_shutdown_SanitizeOnShutdown_OfflineApps" version="1">
      <ind:subexpression datatype="string" entity_check="all" operation="pattern match">[Ff]alse</ind:subexpression>
  </ind:textfilecontent54_state>
  
  <ind:textfilecontent54_object id="obj_firefox_policy-no_sanitize_on_shutdown_SanitizeOnShutdown_Locked" version="1">
    <ind:path var_ref="var_firefox_policy-no_sanitize_on_shutdown_firefox_path" var_check="at least one" datatype="string" />
    <ind:filename datatype="string">policies.json</ind:filename>
    <ind:pattern operation="pattern match">^(?i)\{\s*(?="policies")"policies"[\s]*:[\s]*\{[\s\S]*(?="SanitizeOnShutdown")"SanitizeOnShutdown"[\s]*:[\s]*\{[\s\S]*?(?=[^"])Locked"[\s]*:[\s]*([^,}]+),?\s*</ind:pattern>
    <ind:instance datatype="int">1</ind:instance>
  </ind:textfilecontent54_object>
  <ind:textfilecontent54_state id="state_firefox_policy-no_sanitize_on_shutdown_SanitizeOnShutdown_Locked" version="1">
      <ind:subexpression datatype="string" entity_check="all" operation="pattern match">[Tt]rue</ind:subexpression>
  </ind:textfilecontent54_state>
  
</def-group>
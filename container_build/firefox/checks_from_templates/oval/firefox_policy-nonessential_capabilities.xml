<def-group>
  <definition class="compliance" id="firefox_policy-nonessential_capabilities" version="1">
    <metadata>
        <title>The Firefox New Tab page must not show Top Sites, Sponsored Top sites, Pocket Recommendations, Sponsored Pocket Stories, Searches, Highlights, or Snippets.</title>
            <affected family="unix">
                <platform>Mozilla Firefox</platform>
            </affected>
        <description>Check setting of Disable dynamic New Tab features in Firefox policy</description>
    </metadata> 
    <criteria operator="AND" comment="Test conditions - Firefox policy item is set.">
     
      <criterion comment="Check that Firefox administrative policy setting FirefoxHome.Search to 'false'." test_ref="test_firefox_policy-nonessential_capabilities_FirefoxHome_Search" />
     
      <criterion comment="Check that Firefox administrative policy setting FirefoxHome.TopSites to 'false'." test_ref="test_firefox_policy-nonessential_capabilities_FirefoxHome_TopSites" />
     
      <criterion comment="Check that Firefox administrative policy setting FirefoxHome.SponsoredTopSites to 'false'." test_ref="test_firefox_policy-nonessential_capabilities_FirefoxHome_SponsoredTopSites" />
     
      <criterion comment="Check that Firefox administrative policy setting FirefoxHome.Pocket to 'false'." test_ref="test_firefox_policy-nonessential_capabilities_FirefoxHome_Pocket" />
     
      <criterion comment="Check that Firefox administrative policy setting FirefoxHome.SponsoredPocket to 'false'." test_ref="test_firefox_policy-nonessential_capabilities_FirefoxHome_SponsoredPocket" />
     
      <criterion comment="Check that Firefox administrative policy setting FirefoxHome.Highlights to 'false'." test_ref="test_firefox_policy-nonessential_capabilities_FirefoxHome_Highlights" />
     
      <criterion comment="Check that Firefox administrative policy setting FirefoxHome.Snippets to 'false'." test_ref="test_firefox_policy-nonessential_capabilities_FirefoxHome_Snippets" />
     
      <criterion comment="Check that Firefox administrative policy setting FirefoxHome.locked to 'true'." test_ref="test_firefox_policy-nonessential_capabilities_FirefoxHome_locked" />
     
    </criteria>
  </definition>


  <ind:textfilecontent54_test check="all"
  comment="Check setting of FirefoxHome.Search in Firefox policy file" 
  id="test_firefox_policy-nonessential_capabilities_FirefoxHome_Search" version="1">
  <ind:object object_ref="obj_firefox_policy-nonessential_capabilities_FirefoxHome_Search" />
  <ind:state state_ref="state_firefox_policy-nonessential_capabilities_FirefoxHome_Search" />
  </ind:textfilecontent54_test>


  <ind:textfilecontent54_test check="all"
  comment="Check setting of FirefoxHome.TopSites in Firefox policy file" 
  id="test_firefox_policy-nonessential_capabilities_FirefoxHome_TopSites" version="1">
  <ind:object object_ref="obj_firefox_policy-nonessential_capabilities_FirefoxHome_TopSites" />
  <ind:state state_ref="state_firefox_policy-nonessential_capabilities_FirefoxHome_TopSites" />
  </ind:textfilecontent54_test>


  <ind:textfilecontent54_test check="all"
  comment="Check setting of FirefoxHome.SponsoredTopSites in Firefox policy file" 
  id="test_firefox_policy-nonessential_capabilities_FirefoxHome_SponsoredTopSites" version="1">
  <ind:object object_ref="obj_firefox_policy-nonessential_capabilities_FirefoxHome_SponsoredTopSites" />
  <ind:state state_ref="state_firefox_policy-nonessential_capabilities_FirefoxHome_SponsoredTopSites" />
  </ind:textfilecontent54_test>


  <ind:textfilecontent54_test check="all"
  comment="Check setting of FirefoxHome.Pocket in Firefox policy file" 
  id="test_firefox_policy-nonessential_capabilities_FirefoxHome_Pocket" version="1">
  <ind:object object_ref="obj_firefox_policy-nonessential_capabilities_FirefoxHome_Pocket" />
  <ind:state state_ref="state_firefox_policy-nonessential_capabilities_FirefoxHome_Pocket" />
  </ind:textfilecontent54_test>


  <ind:textfilecontent54_test check="all"
  comment="Check setting of FirefoxHome.SponsoredPocket in Firefox policy file" 
  id="test_firefox_policy-nonessential_capabilities_FirefoxHome_SponsoredPocket" version="1">
  <ind:object object_ref="obj_firefox_policy-nonessential_capabilities_FirefoxHome_SponsoredPocket" />
  <ind:state state_ref="state_firefox_policy-nonessential_capabilities_FirefoxHome_SponsoredPocket" />
  </ind:textfilecontent54_test>


  <ind:textfilecontent54_test check="all"
  comment="Check setting of FirefoxHome.Highlights in Firefox policy file" 
  id="test_firefox_policy-nonessential_capabilities_FirefoxHome_Highlights" version="1">
  <ind:object object_ref="obj_firefox_policy-nonessential_capabilities_FirefoxHome_Highlights" />
  <ind:state state_ref="state_firefox_policy-nonessential_capabilities_FirefoxHome_Highlights" />
  </ind:textfilecontent54_test>


  <ind:textfilecontent54_test check="all"
  comment="Check setting of FirefoxHome.Snippets in Firefox policy file" 
  id="test_firefox_policy-nonessential_capabilities_FirefoxHome_Snippets" version="1">
  <ind:object object_ref="obj_firefox_policy-nonessential_capabilities_FirefoxHome_Snippets" />
  <ind:state state_ref="state_firefox_policy-nonessential_capabilities_FirefoxHome_Snippets" />
  </ind:textfilecontent54_test>


  <ind:textfilecontent54_test check="all"
  comment="Check setting of FirefoxHome.locked in Firefox policy file" 
  id="test_firefox_policy-nonessential_capabilities_FirefoxHome_locked" version="1">
  <ind:object object_ref="obj_firefox_policy-nonessential_capabilities_FirefoxHome_locked" />
  <ind:state state_ref="state_firefox_policy-nonessential_capabilities_FirefoxHome_locked" />
  </ind:textfilecontent54_test>


  <unix:file_object id="obj_firefox_policy-nonessential_capabilities_firefox_path" version="1" comment="Find all installations of Firefox">
    <unix:behaviors recurse_direction="down" max_depth="-1" recurse_file_system="all" />
    <unix:path>/usr</unix:path>
    <unix:filename operation="pattern match">^firefox.sh$|^firefox-bin$</unix:filename>
  </unix:file_object>
  <local_variable id="var_firefox_policy-nonessential_capabilities_firefox_path" version="1" datatype="string" comment="policies.json path for Firefox.">
      <unique>
      <literal_component>/etc/firefox/policies</literal_component>
      <concat>
          <object_component object_ref="obj_firefox_policy-nonessential_capabilities_firefox_path" item_field="path" />
          <literal_component>/distribution</literal_component>
      </concat>
      </unique>
  </local_variable>
  
  <ind:textfilecontent54_object id="obj_firefox_policy-nonessential_capabilities_FirefoxHome_Search" version="1">
    <ind:path var_ref="var_firefox_policy-nonessential_capabilities_firefox_path" var_check="at least one" datatype="string" />
    <ind:filename datatype="string">policies.json</ind:filename>
    <ind:pattern operation="pattern match">^(?i)\{\s*(?="policies")"policies"[\s]*:[\s]*\{[\s\S]*(?="FirefoxHome")"FirefoxHome"[\s]*:[\s]*\{[\s\S]*?(?=[^"])Search"[\s]*:[\s]*([^,}]+),?\s*</ind:pattern>
    <ind:instance datatype="int">1</ind:instance>
  </ind:textfilecontent54_object>
  <ind:textfilecontent54_state id="state_firefox_policy-nonessential_capabilities_FirefoxHome_Search" version="1">
      <ind:subexpression datatype="string" entity_check="all" operation="pattern match">[Ff]alse</ind:subexpression>
  </ind:textfilecontent54_state>
  
  <ind:textfilecontent54_object id="obj_firefox_policy-nonessential_capabilities_FirefoxHome_TopSites" version="1">
    <ind:path var_ref="var_firefox_policy-nonessential_capabilities_firefox_path" var_check="at least one" datatype="string" />
    <ind:filename datatype="string">policies.json</ind:filename>
    <ind:pattern operation="pattern match">^(?i)\{\s*(?="policies")"policies"[\s]*:[\s]*\{[\s\S]*(?="FirefoxHome")"FirefoxHome"[\s]*:[\s]*\{[\s\S]*?(?=[^"])TopSites"[\s]*:[\s]*([^,}]+),?\s*</ind:pattern>
    <ind:instance datatype="int">1</ind:instance>
  </ind:textfilecontent54_object>
  <ind:textfilecontent54_state id="state_firefox_policy-nonessential_capabilities_FirefoxHome_TopSites" version="1">
      <ind:subexpression datatype="string" entity_check="all" operation="pattern match">[Ff]alse</ind:subexpression>
  </ind:textfilecontent54_state>
  
  <ind:textfilecontent54_object id="obj_firefox_policy-nonessential_capabilities_FirefoxHome_SponsoredTopSites" version="1">
    <ind:path var_ref="var_firefox_policy-nonessential_capabilities_firefox_path" var_check="at least one" datatype="string" />
    <ind:filename datatype="string">policies.json</ind:filename>
    <ind:pattern operation="pattern match">^(?i)\{\s*(?="policies")"policies"[\s]*:[\s]*\{[\s\S]*(?="FirefoxHome")"FirefoxHome"[\s]*:[\s]*\{[\s\S]*?(?=[^"])SponsoredTopSites"[\s]*:[\s]*([^,}]+),?\s*</ind:pattern>
    <ind:instance datatype="int">1</ind:instance>
  </ind:textfilecontent54_object>
  <ind:textfilecontent54_state id="state_firefox_policy-nonessential_capabilities_FirefoxHome_SponsoredTopSites" version="1">
      <ind:subexpression datatype="string" entity_check="all" operation="pattern match">[Ff]alse</ind:subexpression>
  </ind:textfilecontent54_state>
  
  <ind:textfilecontent54_object id="obj_firefox_policy-nonessential_capabilities_FirefoxHome_Pocket" version="1">
    <ind:path var_ref="var_firefox_policy-nonessential_capabilities_firefox_path" var_check="at least one" datatype="string" />
    <ind:filename datatype="string">policies.json</ind:filename>
    <ind:pattern operation="pattern match">^(?i)\{\s*(?="policies")"policies"[\s]*:[\s]*\{[\s\S]*(?="FirefoxHome")"FirefoxHome"[\s]*:[\s]*\{[\s\S]*?(?=[^"])Pocket"[\s]*:[\s]*([^,}]+),?\s*</ind:pattern>
    <ind:instance datatype="int">1</ind:instance>
  </ind:textfilecontent54_object>
  <ind:textfilecontent54_state id="state_firefox_policy-nonessential_capabilities_FirefoxHome_Pocket" version="1">
      <ind:subexpression datatype="string" entity_check="all" operation="pattern match">[Ff]alse</ind:subexpression>
  </ind:textfilecontent54_state>
  
  <ind:textfilecontent54_object id="obj_firefox_policy-nonessential_capabilities_FirefoxHome_SponsoredPocket" version="1">
    <ind:path var_ref="var_firefox_policy-nonessential_capabilities_firefox_path" var_check="at least one" datatype="string" />
    <ind:filename datatype="string">policies.json</ind:filename>
    <ind:pattern operation="pattern match">^(?i)\{\s*(?="policies")"policies"[\s]*:[\s]*\{[\s\S]*(?="FirefoxHome")"FirefoxHome"[\s]*:[\s]*\{[\s\S]*?(?=[^"])SponsoredPocket"[\s]*:[\s]*([^,}]+),?\s*</ind:pattern>
    <ind:instance datatype="int">1</ind:instance>
  </ind:textfilecontent54_object>
  <ind:textfilecontent54_state id="state_firefox_policy-nonessential_capabilities_FirefoxHome_SponsoredPocket" version="1">
      <ind:subexpression datatype="string" entity_check="all" operation="pattern match">[Ff]alse</ind:subexpression>
  </ind:textfilecontent54_state>
  
  <ind:textfilecontent54_object id="obj_firefox_policy-nonessential_capabilities_FirefoxHome_Highlights" version="1">
    <ind:path var_ref="var_firefox_policy-nonessential_capabilities_firefox_path" var_check="at least one" datatype="string" />
    <ind:filename datatype="string">policies.json</ind:filename>
    <ind:pattern operation="pattern match">^(?i)\{\s*(?="policies")"policies"[\s]*:[\s]*\{[\s\S]*(?="FirefoxHome")"FirefoxHome"[\s]*:[\s]*\{[\s\S]*?(?=[^"])Highlights"[\s]*:[\s]*([^,}]+),?\s*</ind:pattern>
    <ind:instance datatype="int">1</ind:instance>
  </ind:textfilecontent54_object>
  <ind:textfilecontent54_state id="state_firefox_policy-nonessential_capabilities_FirefoxHome_Highlights" version="1">
      <ind:subexpression datatype="string" entity_check="all" operation="pattern match">[Ff]alse</ind:subexpression>
  </ind:textfilecontent54_state>
  
  <ind:textfilecontent54_object id="obj_firefox_policy-nonessential_capabilities_FirefoxHome_Snippets" version="1">
    <ind:path var_ref="var_firefox_policy-nonessential_capabilities_firefox_path" var_check="at least one" datatype="string" />
    <ind:filename datatype="string">policies.json</ind:filename>
    <ind:pattern operation="pattern match">^(?i)\{\s*(?="policies")"policies"[\s]*:[\s]*\{[\s\S]*(?="FirefoxHome")"FirefoxHome"[\s]*:[\s]*\{[\s\S]*?(?=[^"])Snippets"[\s]*:[\s]*([^,}]+),?\s*</ind:pattern>
    <ind:instance datatype="int">1</ind:instance>
  </ind:textfilecontent54_object>
  <ind:textfilecontent54_state id="state_firefox_policy-nonessential_capabilities_FirefoxHome_Snippets" version="1">
      <ind:subexpression datatype="string" entity_check="all" operation="pattern match">[Ff]alse</ind:subexpression>
  </ind:textfilecontent54_state>
  
  <ind:textfilecontent54_object id="obj_firefox_policy-nonessential_capabilities_FirefoxHome_locked" version="1">
    <ind:path var_ref="var_firefox_policy-nonessential_capabilities_firefox_path" var_check="at least one" datatype="string" />
    <ind:filename datatype="string">policies.json</ind:filename>
    <ind:pattern operation="pattern match">^(?i)\{\s*(?="policies")"policies"[\s]*:[\s]*\{[\s\S]*(?="FirefoxHome")"FirefoxHome"[\s]*:[\s]*\{[\s\S]*?(?=[^"])locked"[\s]*:[\s]*([^,}]+),?\s*</ind:pattern>
    <ind:instance datatype="int">1</ind:instance>
  </ind:textfilecontent54_object>
  <ind:textfilecontent54_state id="state_firefox_policy-nonessential_capabilities_FirefoxHome_locked" version="1">
      <ind:subexpression datatype="string" entity_check="all" operation="pattern match">[Tt]rue</ind:subexpression>
  </ind:textfilecontent54_state>
  
</def-group>
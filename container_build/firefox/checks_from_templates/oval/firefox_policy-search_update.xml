<def-group>
  <definition class="compliance" id="firefox_policy-search_update" version="1">
    <metadata>
        <title>Disable Installed Search Plugins Update Checking</title>
            <affected family="unix">
                <platform>Mozilla Firefox</platform>
            </affected>
        <description>Check setting of Disable Search Plugin Updates in Firefox policy</description>
    </metadata> 
    <criteria operator="AND" comment="Test conditions - Firefox policy item is set.">
     
      <criterion comment="Check that Firefox administrative policy setting Preferences.browser.search.update.Value to 'false'." test_ref="test_firefox_policy-search_update_Preferences_browser.search.update_Value" />
     
      <criterion comment="Check that Firefox administrative policy setting Preferences.browser.search.update.Status to 'locked'." test_ref="test_firefox_policy-search_update_Preferences_browser.search.update_Status" />
     
    </criteria>
  </definition>


  <ind:textfilecontent54_test check="all"
  comment="Check setting of Preferences.browser.search.update.Value in Firefox policy file" 
  id="test_firefox_policy-search_update_Preferences_browser.search.update_Value" version="1">
  <ind:object object_ref="obj_firefox_policy-search_update_Preferences_browser.search.update_Value" />
  <ind:state state_ref="state_firefox_policy-search_update_Preferences_browser.search.update_Value" />
  </ind:textfilecontent54_test>


  <ind:textfilecontent54_test check="all"
  comment="Check setting of Preferences.browser.search.update.Status in Firefox policy file" 
  id="test_firefox_policy-search_update_Preferences_browser.search.update_Status" version="1">
  <ind:object object_ref="obj_firefox_policy-search_update_Preferences_browser.search.update_Status" />
  <ind:state state_ref="state_firefox_policy-search_update_Preferences_browser.search.update_Status" />
  </ind:textfilecontent54_test>


  <unix:file_object id="obj_firefox_policy-search_update_firefox_path" version="1" comment="Find all installations of Firefox">
    <unix:behaviors recurse_direction="down" max_depth="-1" recurse_file_system="all" />
    <unix:path>/usr</unix:path>
    <unix:filename operation="pattern match">^firefox.sh$|^firefox-bin$</unix:filename>
  </unix:file_object>
  <local_variable id="var_firefox_policy-search_update_firefox_path" version="1" datatype="string" comment="policies.json path for Firefox.">
      <unique>
      <literal_component>/etc/firefox/policies</literal_component>
      <concat>
          <object_component object_ref="obj_firefox_policy-search_update_firefox_path" item_field="path" />
          <literal_component>/distribution</literal_component>
      </concat>
      </unique>
  </local_variable>
  
  <ind:textfilecontent54_object id="obj_firefox_policy-search_update_Preferences_browser.search.update_Value" version="1">
    <ind:path var_ref="var_firefox_policy-search_update_firefox_path" var_check="at least one" datatype="string" />
    <ind:filename datatype="string">policies.json</ind:filename>
    <ind:pattern operation="pattern match">^(?i)\{\s*(?="policies")"policies"[\s]*:[\s]*\{[\s\S]*(?="Preferences")"Preferences"[\s]*:[\s]*\{[\s\S]*?(?="browser\.search\.update")"browser\.search\.update"[\s]*:[\s]*\{[\s\S]*?(?=[^"])Value"[\s]*:[\s]*([^,}]+),?\s*</ind:pattern>
    <ind:instance datatype="int">1</ind:instance>
  </ind:textfilecontent54_object>
  <ind:textfilecontent54_state id="state_firefox_policy-search_update_Preferences_browser.search.update_Value" version="1">
      <ind:subexpression datatype="string" entity_check="all" operation="pattern match">[Ff]alse</ind:subexpression>
  </ind:textfilecontent54_state>
  
  <ind:textfilecontent54_object id="obj_firefox_policy-search_update_Preferences_browser.search.update_Status" version="1">
    <ind:path var_ref="var_firefox_policy-search_update_firefox_path" var_check="at least one" datatype="string" />
    <ind:filename datatype="string">policies.json</ind:filename>
    <ind:pattern operation="pattern match">^(?i)\{\s*(?="policies")"policies"[\s]*:[\s]*\{[\s\S]*(?="Preferences")"Preferences"[\s]*:[\s]*\{[\s\S]*?(?="browser\.search\.update")"browser\.search\.update"[\s]*:[\s]*\{[\s\S]*?(?=[^"])Status"[\s]*:[\s]*([^,}]+),?\s*</ind:pattern>
    <ind:instance datatype="int">1</ind:instance>
  </ind:textfilecontent54_object>
  <ind:textfilecontent54_state id="state_firefox_policy-search_update_Preferences_browser.search.update_Status" version="1">
      <ind:subexpression datatype="string" entity_check="all" operation="pattern match">"locked"</ind:subexpression>
  </ind:textfilecontent54_state>
  
</def-group>
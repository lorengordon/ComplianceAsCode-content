prodtype: alinux2,alinux3,anolis8,ol7,ol8,ol9,rhcos4,rhel7,rhel8,rhel9,sle12,sle15,ubuntu2004,ubuntu2204
description: 'To ensure the default umask for users of the Bash shell is set properly,

    add or correct the <tt>umask</tt> setting in <tt>/etc/bashrc</tt> to read

    as follows:

    <pre>umask <sub idref="var_accounts_user_umask" /></pre>'
rationale: 'The umask value influences the permissions assigned to files when they
    are created.

    A misconfigured umask value could result in files with excessive permissions that
    can be read or

    written to by unauthorized users.'
severity: medium
references:
    anssi: BP28(R35)
    cis-csc: '18'
    cobit5: APO13.01,BAI03.01,BAI03.02,BAI03.03
    disa: CCI-000366
    isa-62443-2009: 4.3.4.3.3
    iso27001-2013: A.14.1.1,A.14.2.1,A.14.2.5,A.6.1.5
    nerc-cip: CIP-003-8 R5.1.1,CIP-003-8 R5.3,CIP-004-6 R2.3,CIP-007-3 R2.1,CIP-007-3
        R2.2,CIP-007-3 R2.3,CIP-007-3 R5.1,CIP-007-3 R5.1.1,CIP-007-3 R5.1.2
    nist: AC-6(1),CM-6(a)
    nist-csf: PR.IP-2
    pcidss4: 8.6.1
    srg: SRG-OS-000480-GPOS-00228,SRG-OS-000480-GPOS-00227
    stigid: OL08-00-020353
    stigref: SV-248721r818666_rule
identifiers: {}
ocil_clause: the value for the "umask" parameter is not "<sub idref="var_accounts_user_umask"
    />", or the "umask" parameter is missing or is commented out
ocil: 'Verify the <tt>umask</tt> setting is configured correctly in the <tt>/etc/bashrc</tt>
    file with the following command:


    <pre>$ sudo grep "umask" /etc/bashrc


    umask <sub idref="var_accounts_user_umask" /></pre>'
oval_external_content: null
fixtext: 'Configure Oracle Linux 8 to define default permissions for all authenticated
    users using the bash shell.


    Add or edit the lines for the "umask" parameter in the "/etc/bashrc" files to
    "<sub idref="var_accounts_user_umask" />":


    umask <sub idref="var_accounts_user_umask" />'
checktext: 'Verify the "umask" setting is configured correctly in the "/etc/bashrc"
    file with the following command:


    Note: If the value of the "umask" parameter is set to "000" "/etc/bashrc" file,
    the Severity is raised to a CAT I.


    $ grep umask /etc/bashrc


    umask 077

    umask 077


    If the value for the "umask" parameter is not "077", or the "umask" parameter
    is missing or is commented out, this is a finding.'
vuldiscussion: ''
srg_requirement: Oracle Linux 8 must define default permissions for the bash shell.
warnings: []
conflicts: []
requires: []
policy_specific_content:
    stig:
        srg_requirement: Oracle Linux 8 must define default permissions for the bash
            shell.
        vuldiscussion: The umask controls the default access mode assigned to newly
            created files. A umask of 077 limits new files to mode 600 or less permissive.
            Although umask can be represented as a four-digit number, the first digit
            representing special access modes is typically ignored or required to
            be "0". This requirement applies to the globally configured system defaults
            and the local interactive user defaults for each account on the system.
        checktext: 'Verify the "umask" setting is configured correctly in the "/etc/bashrc"
            file with the following command:


            Note: If the value of the "umask" parameter is set to "000" "/etc/bashrc"
            file, the Severity is raised to a CAT I.


            $ grep umask /etc/bashrc


            umask 077

            umask 077


            If the value for the "umask" parameter is not "077", or the "umask" parameter
            is missing or is commented out, this is a finding.'
        fixtext: 'Configure Oracle Linux 8 to define default permissions for all authenticated
            users using the bash shell.


            Add or edit the lines for the "umask" parameter in the "/etc/bashrc" file
            to "077":


            umask 077'
platform: null
platforms: !!set {}
sce_metadata: {}
inherited_platforms: !!set {}
cpe_platform_names: !!set {}
inherited_cpe_platform_names: !!set {}
bash_conditional: null
fixes: {}
title: Ensure the Default Bash Umask is Set Correctly
definition_location: /home/oscap/content/linux_os/guide/system/accounts/accounts-session/user_umask/accounts_umask_etc_bashrc/rule.yml
template: null
documentation_complete: true

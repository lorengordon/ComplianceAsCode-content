prodtype: fedora,ol8,ol9,rhcos4,rhel8,rhel9
description: "The USBGuard service should be enabled.\n\nThe <code>usbguard</code>\
    \ service can be enabled with the following manifest:\n<pre>\n---\napiVersion:\
    \ machineconfiguration.openshift.io/v1\nkind: MachineConfig\nmetadata:\n  labels:\n\
    \    machineconfiguration.openshift.io/role: master\n  name: 75-master-usbguard-enable\n\
    spec:\n  config:\n    ignition:\n      version: 3.1.0\n    systemd:\n      units:\n\
    \      - name: usbguard.service\n        enabled: true\n</pre>\n<p>\nThis will\
    \ enable the <tt>usbguard</tt> service in all the\nnodes labeled with the \"master\"\
    \ role.\n</p>\n<p>\nNote that this needs to be done for each <tt>MachineConfigPool</tt>\n\
    </p>\n<p>\nFor more information on how to configure nodes with the Machine Config\n\
    Operator see\n<a xmlns='http://www.w3.org/1999/xhtml' href='https://docs.openshift.com/container-platform/4.6/post_installation_configuration/machine-configuration-tasks.html'>the\
    \ relevant documentation</a>.\n</p>"
rationale: 'The <tt>usbguard</tt> service must be running in order to

    enforce the USB device authorization policy for all USB devices.'
severity: medium
references:
    disa: CCI-000416,CCI-001958
    ism: '1418'
    nist: CM-8(3)(a),IA-3
    ospp: FMT_SMF_EXT.1
    srg: SRG-OS-000378-GPOS-00163
identifiers:
    cce: CCE-82537-2
ocil_clause: the service is not enabled
ocil: '

    As a user with administrator privileges, log into a node in the relevant pool:

    <pre>

    $ oc debug node/$NODE_NAME

    </pre>

    At the <pre>sh-4.4#</pre> prompt, run:

    <pre>

    # chroot /host

    </pre>


    Run the following command to determine the current status of the

    <code>usbguard</code> service:

    <pre>$ sudo systemctl is-active usbguard</pre>

    If the service is running, it should return the following: <pre>active</pre>'
oval_external_content: null
fixtext: 'To enable the usbguard service run the following command:


    $ sudo systemctl enable --now usbguard'
checktext: ''
vuldiscussion: ''
srg_requirement: The Red Hat Enterprise Linux CoreOS 4 service usbguard must be enabled.
warnings: []
conflicts: []
requires: []
policy_specific_content:
    stig:
        srg_requirement: Red Hat Enterprise Linux CoreOS 4 must have the USBGuard
            package enabled.
        vuldiscussion: 'The USBguard-daemon is the main component of the USBGuard
            software framework. It runs as a service in the background and enforces
            the USB device authorization policy for all USB devices. The policy is
            defined by a set of rules using a rule language described in the usbguard-rules.conf
            file. The policy and the authorization state of USB devices can be modified
            during runtime using the usbguard tool.


            The System Administrator (SA) must work with the site Information System
            Security Officer (ISSO) to determine a list of authorized peripherals
            and establish rules within the USBGuard software framework to allow only
            authorized devices.'
        checktext: 'Verify Red Hat Enterprise Linux CoreOS 4 has USBGuard enabled
            with the following command:


            $ systemctl is-active usbguard


            active


            If usbguard is not active, ask the SA to indicate how unauthorized peripherals
            are being blocked.

            If there is no evidence that unauthorized peripherals are being blocked
            before establishing a connection, this is a finding.'
        fixtext: 'To enable the USBGuard service run the following command:


            $ sudo systemctl enable --now usbguard'
platform: null
platforms: !!set {}
sce_metadata: {}
inherited_platforms: !!set
    not_s390x_arch and machine: null
cpe_platform_names: !!set {}
inherited_cpe_platform_names: !!set
    machine_and_not_s390x_arch: null
bash_conditional: null
fixes: {}
title: Enable the USBGuard Service
definition_location: /home/oscap/content/linux_os/guide/services/usbguard/service_usbguard_enabled/rule.yml
template:
    name: service_enabled
    vars:
        servicename: usbguard
    backends: {}
documentation_complete: true

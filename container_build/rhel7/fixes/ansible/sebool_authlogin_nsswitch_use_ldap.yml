# platform = multi_platform_rhel,multi_platform_fedora,multi_platform_ol,multi_platform_rhv,SUSE Linux Enterprise 15
# reboot = false
# strategy = enable
# complexity = low
# disruption = low
- (xccdf-var var_authlogin_nsswitch_use_ldap)

- name: Ensure libsemanage-python installed
  package:
    name: libsemanage-python
    state: present
  when:
  - ansible_virtualization_type not in ["docker", "lxc", "openvz", "podman", "container"]
  - not ( lookup("env", "container") == "bwrap-osbuild" )
  tags:
  - CCE-80425-2
  - NIST-800-171-3.7.2
  - enable_strategy
  - low_complexity
  - low_disruption
  - medium_severity
  - no_reboot_needed
  - sebool_authlogin_nsswitch_use_ldap

- name: Set SELinux boolean authlogin_nsswitch_use_ldap accordingly
  seboolean:
    name: authlogin_nsswitch_use_ldap
    state: '{{ var_authlogin_nsswitch_use_ldap }}'
    persistent: true
  when:
  - ansible_virtualization_type not in ["docker", "lxc", "openvz", "podman", "container"]
  - not ( lookup("env", "container") == "bwrap-osbuild" )
  tags:
  - CCE-80425-2
  - NIST-800-171-3.7.2
  - enable_strategy
  - low_complexity
  - low_disruption
  - medium_severity
  - no_reboot_needed
  - sebool_authlogin_nsswitch_use_ldap

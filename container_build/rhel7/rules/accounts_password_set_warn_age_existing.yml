prodtype: rhel7,rhel8,rhel9,sle12,sle15
description: 'To configure how many days prior to password expiration that a warning
    will be issued to

    users, run the command:

    <pre>$ sudo chage --warndays <sub idref="var_accounts_password_warn_age_login_defs"
    /> <i>USER</i></pre>

    The DoD requirement is 7, and CIS recommendation is no less than 7 days.

    This profile requirement is <tt><sub idref="var_accounts_password_warn_age_login_defs"
    /></tt>.'
rationale: "Providing an advance warning that a password will be expiring gives users\
    \ \ntime to think of a secure password. Users caught unaware may choose a simple\
    \ \npassword or write it down where it may be discovered."
severity: medium
references:
    disa: CCI-000198
    nist: IA-5(f),IA-5(1)(d),CM-6(a)
    cis: 5.5.1.3
identifiers:
    cce: CCE-86913-1
ocil_clause: any results are returned that are not associated with a system account
ocil: 'Verify that Red Hat Enterprise Linux 7 set the days of warning before a password
    expires to

    <sub idref="var_accounts_password_warn_age_login_defs" /> or more for users with
    a

    password:


    $ sudo awk -F: ''$6 < <sub idref="var_accounts_password_warn_age_login_defs" />
    || $6 == "" {print $1}'' /etc/shadow'
oval_external_content: null
fixtext: "Configure non-compliant accounts to ensure the number of days of warning\
    \ before password\nexpires is set to <sub idref=\"var_accounts_password_warn_age_login_defs\"\
    \ />:\nusrs_pass_warn_age=( $(awk -F: '$6 < <sub idref=\"var_accounts_password_warn_age_login_defs\"\
    \ /> || $6 == \"\" {print $1}' /etc/shadow) )\nfor i in ${usrs_pass_warn_age[@]};\n\
    do\n   chage --warndays <sub idref=\"var_accounts_password_warn_age_login_defs\"\
    \ /> $i\ndone"
checktext: ''
vuldiscussion: ''
srg_requirement: ''
warnings: []
conflicts: []
requires: []
policy_specific_content: {}
platform: null
platforms: !!set {}
sce_metadata: {}
inherited_platforms: !!set {}
cpe_platform_names: !!set {}
inherited_cpe_platform_names: !!set {}
bash_conditional: null
fixes: {}
title: Set Existing Passwords Warning Age
definition_location: /home/oscap/content/linux_os/guide/system/accounts/accounts-restrictions/password_expiration/accounts_password_set_warn_age_existing/rule.yml
template: null
documentation_complete: true

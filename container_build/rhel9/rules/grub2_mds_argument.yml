prodtype: fedora,rhel9
description: 'Microarchitectural Data Sampling (MDS) is a hardware vulnerability which
    allows unprivileged

    speculative access to data which is available in various CPU internal buffers.


    When performing store, load, L1 refill operations, processors write data into
    temporary

    microarchitectural structures (buffers), and the data in the buffer can be forwarded
    to load

    operations as an optimization.


    Under certain conditions, data unrelated to the load operations can be speculatively

    forwarded from the buffers to a disclosure gadget which allows in turn to infer
    the value

    via a cache side channel attack.


    Select the appropriate mitigation by adding the argument

    <tt>mds=<sub idref="var_mds_options" /></tt> to the default

    GRUB 2 command line for the Linux operating system.

    To ensure that <tt>mds=<sub idref="var_mds_options" /></tt> is added as a kernel
    command line

    argument to newly installed kernels, add <tt>mds=<sub idref="var_mds_options"
    /></tt> to the

    default Grub2 command line for Linux operating systems. Modify the line within

    <tt>/etc/default/grub</tt> as shown below:

    <pre>GRUB_CMDLINE_LINUX="... mds=<sub idref="var_mds_options" /> ..."</pre>

    Run the following command to update command line for already installed kernels:<pre>#
    grubby --update-kernel=ALL --args="mds=<sub idref="var_mds_options" />"</pre>


    Not all processors are affected by all variants of MDS, but the mitigation mechanism
    is

    identical for all of them.


    Since Linux Kernel 5.2 you can check whether the system is vulnerable or mitigated
    with the

    following command:

    <tt>cat /sys/devices/system/cpu/vulnerabilities/mds</tt>'
rationale: The MDS vulnerability allows an attacker to sample data from internal CPU
    buffers.
severity: medium
references: {}
identifiers:
    cce: CCE-90456-5
ocil_clause: MDS mitigations are not configured appropriately
ocil: 'Inspect the form of default GRUB 2 command line for the Linux operating system

    in <tt>/etc/default/grub</tt>. If it includes <tt>mds=<sub idref="" /></tt>,

    then the parameter will be configured for newly installed kernels.

    First check if the GRUB recovery is enabled:

    <pre>$ sudo grep ''GRUB_DISABLE_RECOVERY'' /etc/default/grub</pre>

    If this option is set to true, then check that a line is output by the following
    command:

    <pre>$ sudo grep ''GRUB_CMDLINE_LINUX_DEFAULT.*mds=<sub idref="" />.*'' /etc/default/grub</pre>

    If the recovery is disabled, check the line with

    <pre>$ sudo grep ''GRUB_CMDLINE_LINUX.*mds=<sub idref="" />.*'' /etc/default/grub</pre>.Moreover,
    command line parameters for currently installed kernels should be checked as well.

    Run the following command:

    <pre>$ sudo grubby --info=ALL | grep args | grep -v ''mds=<sub idref="" />''</pre>

    The command should not return any output.'
oval_external_content: null
fixtext: ''
checktext: ''
vuldiscussion: ''
srg_requirement: ''
warnings:
-   performance: 'Enabling MDS mitigations will impact performance of the system,
        mainly by workloads with

        high rates of user-kernel-user space transitions. For example, system calls,
        NMIs and interrupts.'
conflicts: []
requires: []
policy_specific_content: {}
platform: machine
platforms: !!set
    machine: null
sce_metadata: {}
inherited_platforms: !!set
    grub2: null
cpe_platform_names: !!set
    machine: null
inherited_cpe_platform_names: !!set
    grub2: null
bash_conditional: null
fixes: {}
title: Configure Microarchitectural Data Sampling mitigation
definition_location: /home/oscap/content/linux_os/guide/system/bootloader-grub2/grub2_mds_argument/rule.yml
template:
    name: grub2_bootloader_argument
    vars:
        arg_name: mds
        arg_variable: var_mds_options
    backends: {}
documentation_complete: true

prodtype: sle12,sle15,ubuntu2004
description: 'Do not allow users to reuse recent passwords. This can be

    accomplished by using the <tt>remember</tt> option for the

    <tt>pam_pwhistory</tt> PAM modules.

    <br /><br />

    In the file <tt>/etc/pam.d/common-password</tt>, make sure the parameters

    <tt>remember</tt> and <tt>use_authtok</tt> are present, and that the value

    for the <tt>remember</tt> parameter is <sub idref="var_password_pam_remember"
    /> or greater. For example:

    <pre>password requisite pam_pwhistory.so <i>...existing_options...</i> remember=<sub
    idref="var_password_pam_remember" /> use_authtok</pre>

    The DoD STIG requirement is 5 passwords.'
rationale: Preventing re-use of previous passwords helps ensure that a compromised
    password is not re-used by a user.
severity: medium
references:
    disa: CCI-000200
    srg: SRG-OS-000077-GPOS-00045
    cis: 5.3.3
identifiers: {}
ocil_clause: the value of remember is not set equal to or greater than <sub idref="var_password_pam_remember"
    />
ocil: 'Check that the SUSE operating system prohibits the reuse of a password for

    a minimum of <tt><sub idref="var_password_pam_remember" /></tt> generations with
    the following command:

    <pre># grep pam_pwhistory.so /etc/pam.d/common-password

    password requisite pam_pwhistory.so remember=<sub idref="var_password_pam_remember"
    /> use_authtok</pre>

    If the command does not return a result, or the returned line is commented

    out, has a second column value different from "requisite", does not contain

    "remember" value, the value is less than

    <tt><sub idref="var_password_pam_remember" /></tt>, or is missing the

    "use_authtok" keyword, this is a finding.'
oval_external_content: null
fixtext: ''
checktext: ''
vuldiscussion: ''
srg_requirement: ''
warnings: []
conflicts: []
requires: []
policy_specific_content: {}
platform: package[pam]
platforms: !!set
    package[pam]: null
sce_metadata: {}
inherited_platforms: !!set {}
cpe_platform_names: !!set
    package_pam: null
inherited_cpe_platform_names: !!set {}
bash_conditional: null
fixes: {}
title: Limit Password Reuse
definition_location: /home/oscap/content/linux_os/guide/system/accounts/accounts-pam/locking_out_password_attempts/accounts_password_pam_pwhistory_remember/rule.yml
template:
    name: pam_options
    vars:
        path: /etc/pam.d/common-password
        type: password
        control_flag: requisite
        module: pam_pwhistory.so
        arguments:
        -   variable: remember
            operation: greater than or equal
        -   argument: use_authtok
            new_argument: use_authtok
    backends: {}
documentation_complete: true
